# nimo PLM 系统重构设计 V2.0

> 基于 V1.0 流程设计的系统落地方案。核心理念：**以研发项目为中心，BOM/图纸/变更都是项目过程的产物**。
> PLM 只管到研发阶段（立项→量产放行），量产后的产品/库存/财务留给 ERP。

---

## 一、系统定位与边界

### 1.1 PLM 管什么

```
┌─────────────────────────── PLM 边界 ──────────────────────────────┐
│                                                                    │
│  研发项目管理        研发BOM管理         研发图纸/文档管理           │
│  ┌──────────┐       ┌──────────┐       ┌──────────────┐           │
│  │ 平台项目  │──────▶│ 电子BOM  │──────▶│ 原理图/PCB   │           │
│  │ 产品项目  │──────▶│ 结构BOM  │──────▶│ 3D/2D图纸    │           │
│  │ 阶段门控  │──────▶│ 固件BOM  │──────▶│ 设计文档     │           │
│  │ 任务甘特  │       │ BOM演进  │       │ 测试报告     │           │
│  └──────────┘       └──────────┘       └──────────────┘           │
│       │                   │                    │                   │
│       ▼                   ▼                    ▼                   │
│  ┌──────────┐       ┌──────────┐       ┌──────────────┐           │
│  │ 交付物管理│       │ ECN变更  │       │ 物料选型库   │           │
│  │ 阶段checklist│    │ 变更审批 │       │ 规格/供应商  │           │
│  └──────────┘       └──────────┘       └──────────────┘           │
│                                                                    │
└──────────────────────────────┬─────────────────────────────────────┘
                               │ G4量产放行
                               ▼
                    ┌──────────────────┐
                    │   mBOM冻结推送   │
                    │   → ERP 系统     │
                    │  (产品/库存/采购) │
                    └──────────────────┘
```

### 1.2 PLM 不管什么（留给 ERP）

| 功能 | 归属 | 说明 |
|------|------|------|
| 产品SKU管理 | ERP | 量产后才有正式SKU |
| 物料库存 | ERP | 仓储出入库 |
| 采购订单 | ERP | 供应链管理 |
| 生产排程 | MES | 工厂排产 |
| 财务核算 | ERP | 成本/营收 |

### 1.3 PLM → ERP 接口（预留）

```
PLM 量产放行(G4)
    ├── mBOM 冻结 ──推送──▶ ERP 产品BOM
    ├── 物料主数据 ──同步──▶ ERP 物料档案
    └── 认证文件 ──归档──▶ 文档系统
```

---

## 二、项目代号体系

### 2.1 平台项目代号

从"微光"到"鸿蒙"，取自中国传统文化，层层递进，体现平台代际演进：

| 代次 | 代号 | 编码 | 含义 | 主题 |
|------|------|------|------|------|
| Gen 1 | 微光 | PLT-WG | 微弱之光，万物初始 | 光之起源 |
| Gen 2 | 晨曦 | PLT-CX | 破晓微光 | 天色将明 |
| Gen 3 | 朝霞 | PLT-ZX | 霞光万道 | 日出之前 |
| Gen 4 | 旭日 | PLT-XR | 旭日东升 | 冉冉升起 |
| Gen 5 | 明辉 | PLT-MH | 光明辉映 | 光芒绽放 |
| Gen 6 | 皓月 | PLT-HY | 皓月当空 | 月之清辉 |
| Gen 7 | 星河 | PLT-XH | 银河璀璨 | 仰望星空 |
| Gen 8 | 天枢 | PLT-TS | 北斗第一星 | 星辰导航 |
| Gen 9 | 瑶光 | PLT-YG | 北斗第七星 | 玉光闪耀 |
| Gen 10 | 紫微 | PLT-ZW | 帝星，众星之主 | 紫微垣 |
| Gen 11 | 青龙 | PLT-QL | 东方之神 | 四象之一 |
| Gen 12 | 朱雀 | PLT-ZQ | 南方之神 | 四象之二 |
| Gen 13 | 玄武 | PLT-XW | 北方之神 | 四象之三 |
| Gen 14 | 白虎 | PLT-BH | 西方之神 | 四象之四 |
| Gen 15 | 麒麟 | PLT-QL | 瑞兽之首 | 太平盛世 |
| Gen 16 | 凤凰 | PLT-FH | 百鸟之王 | 涅槃重生 |
| Gen 17 | 鲲鹏 | PLT-KP | 展翅九万里 | 逍遥游 |
| Gen 18 | 九天 | PLT-JT | 九重天阙 | 天界之巅 |
| Gen 19 | 太极 | PLT-TJ | 阴阳之源 | 万物之本 |
| Gen 20 | 鸿蒙 | PLT-HM | 天地未开之始 | 宇宙本源 |

### 2.2 镜框（产品项目）代号

星际主题，随取随用，不限数量：

```
Nova, BigBang, BlackHole, Galaxy, Venus, Mars, Orion, Pulsar,
Quasar, Nebula, Eclipse, Aurora, Meteor, Comet, Zenith, Horizon,
Spectrum, Stellar, Cosmos, Vortex, Lunar, Titan, Atlas, Phoenix,
Sirius, Andromeda, Cassini, Voyager, Polaris, Solaris
```

### 2.3 编码规则

```
平台项目: PLT-{代号缩写}-{年份}     例: PLT-WG-2026（微光平台）
产品项目: PRD-{平台代号}-{镜框代号}  例: PRD-WG-Nova（微光平台·Nova镜框）
```

---

## 三、核心模块设计

### 3.1 模块总览

```
┌─────────────────────────────────────────────────────────────┐
│                     nimo PLM 系统架构                        │
├──────────┬──────────┬──────────┬──────────┬─────────────────┤
│  项目管理 │  BOM管理  │ 图纸文档  │ ECN变更  │  物料选型库     │
│  (核心)   │ (项目产物) │ (项目附件) │(变更控制) │  (支撑库)       │
├──────────┴──────────┴──────────┴──────────┴─────────────────┤
│                       基础设施                               │
│           用户/角色/权限 · 飞书SSO · 审批引擎                 │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 模块一：研发项目管理（核心）

**这是整个系统的入口和中枢。用户进入PLM，第一眼看到的是自己参与的项目。**

#### 3.2.1 项目类型

| 类型 | 说明 | 模板 | 代号来源 |
|------|------|------|----------|
| 平台项目 | 核心硬件平台，1-2代/年 | 平台研发模板（181任务） | 中国传统文化 |
| 产品项目 | 基于平台的镜框SKU，数十款/年 | 产品研发模板（~30任务） | 星际英文名 |

#### 3.2.2 项目生命周期

```
创建项目（选模板 + 选代号）
    │
    ▼
┌──────────────────────────────────────────────────────┐
│  Concept ──G0──▶ EVT ──G1──▶ DVT ──G2──▶ PVT ──G3──▶ MP ──G4──▶ 量产放行 │
│                                                                    │
│  每个阶段内：                                                       │
│  ├── 任务执行（甘特图）                                              │
│  ├── BOM 提交/审批/发布                                              │
│  ├── 图纸/文档上传                                                   │
│  ├── 交付物 checklist 完成                                           │
│  └── 阶段门评审 → 进入下一阶段                                       │
└──────────────────────────────────────────────────────┘
```

#### 3.2.3 阶段门控（Phase Gate）

每个阶段门评审需要：
1. **所有必选交付物已提交** — 系统自动检查
2. **当前阶段BOM已审批通过** — 系统自动检查
3. **关键任务已完成** — is_critical 任务全部 done
4. **评审会议记录** — 上传评审纪要
5. **评审决策** — Go / No-Go / 有条件通过

```
评审结果：
  ├── Go → 阶段状态变为 completed，下一阶段自动激活
  ├── No-Go → 项目暂停或终止
  └── 有条件通过 → 记录条件，限期整改后自动进入下一阶段
```

#### 3.2.4 交付物管理

每个阶段预定义了必须提交的交付物清单：

| 阶段 | 关键交付物 | 责任角色 | 类型 |
|------|-----------|----------|------|
| Concept | 产品需求规格书(PRD) | 产品经理 | 文档 |
| Concept | 可行性评估报告 | 技术负责人 | 文档 |
| Concept | 概念BOM(cBOM) | 硬件负责人 | BOM |
| Concept | 概念ID设计方案 | 工业设计师 | 图纸 |
| EVT | 原理图 & PCB文件 | 硬件工程师 | 图纸 |
| EVT | EVT BOM(eBOM) | 硬件工程师 | BOM |
| EVT | 光学设计报告 | 光学工程师 | 文档 |
| EVT | 结构设计文件(3D+2D) | 结构工程师 | 图纸 |
| EVT | ID设计定稿 | 工业设计师 | 图纸 |
| EVT | EVT测试报告 | 测试工程师 | 文档 |
| DVT | DVT BOM(dBOM) | 硬件工程师 | BOM |
| DVT | 模具验收报告 | 结构工程师 | 文档 |
| DVT | 可靠性测试报告 | 测试工程师 | 文档 |
| DVT | 认证预测试报告 | 认证工程师 | 文档 |
| PVT | PVT BOM(pBOM) | 硬件工程师 | BOM |
| PVT | SOP作业指导书 | 工艺工程师 | 文档 |
| PVT | 良率分析报告 | 品质工程师 | 文档 |
| PVT | 认证证书 | 认证工程师 | 文档 |
| MP | 量产BOM(mBOM) | 硬件负责人 | BOM |
| MP | 量产放行报告 | 项目经理 | 文档 |

### 3.3 模块二：研发BOM管理

**核心理念：BOM 不是独立创建的，BOM 是研发项目的输出产物。**

#### 3.3.1 BOM 的产生方式

```
研发项目进行中
    │
    ├── 硬件工程师 ──提交──▶ 电子BOM (EBOM)
    │   包含：SoC、蓝牙芯片、存储、传感器、电池、PCB、FPC...
    │
    ├── 结构工程师 ──提交──▶ 结构BOM (SBOM)
    │   包含：镜腿壳体、桩头、镜架、脚套、螺丝、胶水...
    │
    ├── 光学工程师 ──提交──▶ 光学BOM (OBOM)
    │   包含：波导、MicroLED光机、棱镜...
    │
    └── 嵌入式工程师 ──提交──▶ 固件BOM (FWBOM)
        包含：主控固件、蓝牙固件、充电管理固件（版本号+配置）
```

#### 3.3.2 BOM 阶段演进

```
  Concept        EVT           DVT           PVT           MP
    │              │             │             │             │
  cBOM ────────▶ eBOM ────────▶ dBOM ────────▶ pBOM ────────▶ mBOM
  (概念级)      (器件级)       (设计稳定)     (试产验证)     (量产冻结)
    │              │             │             │             │
  模组级粗略    完整器件清单   优化后BOM      试产验证版    最终冻结版
  识别关键物料  标注替代料     趋于稳定       良率验证      推送给ERP
```

#### 3.3.3 BOM 状态流转

```
草稿(draft) ──提交──▶ 待审批(pending_review) ──审批通过──▶ 已发布(published) ──阶段门冻结──▶ 已冻结(frozen)
                              │                                    │
                          审批驳回──▶ 草稿                     修改需ECN──▶ ECN审批流程
```

#### 3.3.4 BOM 审批权限（随阶段递进）

| 阶段 | 审批人 | 说明 |
|------|--------|------|
| Concept (cBOM) | 硬件负责人 | 概念级，快速审批 |
| EVT (eBOM) | 硬件负责人 | 器件级确认 |
| DVT (dBOM) | 硬件负责人 + 项目经理 | 设计基本定型 |
| PVT (pBOM) | 硬件负责人 + 项目经理 + 采购 | 涉及量产采购 |
| MP (mBOM) | 硬件负责人 + 项目经理 + 采购 + 品质 + VP | 最终冻结 |

#### 3.3.5 BOM 数据结构

```
项目BOM (ProjectBOM)
├── 版本号: v1.0 / v1.1 / v2.0
├── 阶段: concept / evt / dvt / pvt / mp
├── 类型: EBOM(电子) / SBOM(结构) / OBOM(光学) / FWBOM(固件)
├── 状态: draft / pending_review / published / frozen
├── 提交人 / 审批人 / 审批时间
│
└── BOM Items (物料行项)
    ├── 物料编号 (关联物料选型库)
    ├── 物料名称
    ├── 规格描述
    ├── 数量
    ├── 单位
    ├── 位号/位置 (如 R1,R2,C1 — 电子件专用)
    ├── 供应商
    ├── 替代料标记
    ├── 备注
    │
    └── 关联图纸 (设计文件引用)
```

### 3.4 模块三：研发图纸/文档管理

**核心理念：图纸和文档是项目的附件，关联到项目阶段和BOM物料。**

#### 3.4.1 文档分类

| 类别 | 文件类型 | 来源角色 | 示例 |
|------|----------|----------|------|
| 电子设计 | 原理图、PCB Layout、Gerber | 硬件工程师 | Main_PCB_v2.1.SchDoc |
| 结构设计 | 3D模型、2D工程图、装配图 | 结构工程师 | Temple_R_v3.stp |
| 光学设计 | 光路仿真、光学参数报告 | 光学工程师 | Waveguide_sim_v1.pdf |
| ID设计 | 外观效果图、CMF方案、手板照片 | 工业设计师 | ID_concept_v2.psd |
| 固件 | 固件二进制、配置文件、烧录说明 | 嵌入式工程师 | fw_main_v1.2.3.bin |
| 测试报告 | 功能测试、可靠性、认证报告 | 测试/认证 | DVT_reliability_report.pdf |
| 项目文档 | PRD、计划、评审纪要 | 项目经理/PM | Phase_G1_review_minutes.docx |

#### 3.4.2 文档版本管理

```
文档(Document)
├── 文档编号: DOC-{项目代号}-{类别}-{序号}
├── 名称
├── 类别: electrical / mechanical / optical / id_design / firmware / test / project
├── 关联项目ID
├── 关联BOM Item ID (可选)
├── 当前版本号
│
└── 版本历史 (DocumentVersion)
    ├── 版本号: v1.0, v1.1, v2.0
    ├── 文件存储路径 (MinIO)
    ├── 文件大小 / 格式
    ├── 上传人
    ├── 上传时间
    ├── 变更说明
    └── 关联ECN编号 (如有)
```

### 3.5 模块四：ECN 变更管理

**核心理念：ECN 控制对 BOM 和图纸的变更，审批严格度随阶段递进。**

#### 3.5.1 ECN 触发场景

```
工程师发现需要变更 BOM 或图纸
    │
    ├── 当前阶段是 Concept → 自由修改，无需ECN
    │
    ├── 当前阶段是 EVT → 提交 ECN，硬件负责人审批
    │
    ├── 当前阶段是 DVT → 提交 ECN，硬件负责人 + 项目经理审批
    │
    ├── 当前阶段是 PVT → 提交 ECN，+ 采购 + 品质审批
    │
    └── 当前阶段是 MP → 提交 ECN，VP级审批（重大变更需CEO）
```

#### 3.5.2 ECN 与 BOM 的关系

```
ECN 变更申请
├── 变更原因
├── 影响范围（哪些BOM/图纸受影响）
├── 变更前内容（自动快照）
├── 变更后内容（工程师填写）
├── 成本影响评估
├── 时间影响评估
│
├── 审批链（基于当前阶段自动匹配）
│
└── 审批通过后：
    ├── 自动更新 BOM 版本 (v1.0 → v1.1)
    ├── 自动更新相关图纸版本
    └── 记录变更历史（完整追溯）
```

### 3.6 模块五：物料选型库

**核心理念：PLM 只管物料的规格参数和选型信息，不管库存。**

#### 3.6.1 物料信息

```
物料(Material)
├── 物料编号: MAT-{类别}-{序号}
├── 名称
├── 类别: IC / 被动元件 / 连接器 / 结构件 / 光学件 / 电池 / ...
├── 规格描述
├── 封装/尺寸
├── 制造商
├── 制造商料号
├── 供应商列表 (可多个)
│   ├── 供应商名称
│   ├── 供应商料号
│   ├── 单价 (参考价)
│   └── 交期 (参考交期)
├── 数据手册链接
├── 状态: active / deprecated / eol(停产)
├── 替代料列表
└── 备注
```

#### 3.6.2 物料与BOM的关系

```
BOM Item 引用 物料编号
    │
    ├── 自动关联物料信息（规格、供应商、交期）
    ├── 支持在BOM中标注"替代料"
    └── 物料状态变更(如停产)时，自动通知引用该物料的项目
```

---

## 四、数据模型

### 4.1 核心实体关系

```
                                    ┌─────────────┐
                                    │   用户/角色   │
                                    └──────┬──────┘
                                           │
┌──────────────────────────────────────────┼────────────────────────────────┐
│                                          │                                │
│  ┌────────────┐    ┌────────────┐   ┌────┴─────┐   ┌──────────────┐      │
│  │ 项目模板    │───▶│  研发项目   │───│  项目成员  │   │  项目代号库   │      │
│  │ (Template) │    │ (Project)  │   │ (Member) │   │ (Codename)  │      │
│  └────────────┘    └─────┬──────┘   └──────────┘   └──────────────┘      │
│                          │                                                │
│            ┌─────────────┼──────────────┬──────────────┐                  │
│            ▼             ▼              ▼              ▼                  │
│     ┌────────────┐ ┌──────────┐  ┌───────────┐  ┌──────────┐            │
│     │ 项目阶段    │ │ 项目任务  │  │  项目BOM   │  │ 项目文档  │            │
│     │ (Phase)    │ │ (Task)   │  │(ProjectBOM)│  │(Document)│            │
│     └─────┬──────┘ └──────────┘  └──────┬─────┘  └──────────┘            │
│           │                             │                                 │
│           ▼                             ▼                                 │
│     ┌────────────┐              ┌──────────────┐                         │
│     │ 阶段交付物  │              │  BOM行项     │──▶ 物料选型库            │
│     │(Deliverable)│              │ (BOMItem)    │    (Material)           │
│     └────────────┘              └──────────────┘                         │
│                                        │                                  │
│                                        ▼                                  │
│                                 ┌──────────────┐                         │
│                                 │   ECN变更     │                         │
│                                 │(ChangeOrder) │                         │
│                                 └──────────────┘                         │
└──────────────────────────────────────────────────────────────────────────┘
```

### 4.2 核心表设计

#### projects (研发项目)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | UUID | 主键 |
| code | VARCHAR(32) | 项目编码 PLT-WG-2026 |
| name | VARCHAR(128) | 项目名称 |
| codename | VARCHAR(32) | 内部代号（微光/Nova等）|
| project_type | VARCHAR(16) | platform / product |
| platform_id | UUID | 产品项目关联的平台项目ID |
| current_phase | VARCHAR(16) | concept/evt/dvt/pvt/mp |
| status | VARCHAR(16) | planning/active/on_hold/completed/cancelled |
| start_date | DATE | 项目开始日期 |
| planned_end | DATE | 计划结束日期 |
| actual_end | DATE | 实际结束日期 |
| manager_id | UUID | 项目经理 |
| progress | INT | 0-100 整体进度 |
| description | TEXT | 项目描述 |
| created_by | UUID | 创建人 |

#### project_phases (项目阶段)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | UUID | 主键 |
| project_id | UUID | 关联项目 |
| phase | VARCHAR(16) | concept/evt/dvt/pvt/mp |
| name | VARCHAR(64) | 阶段显示名 |
| status | VARCHAR(16) | pending/active/completed/skipped |
| sequence | INT | 排序 1-5 |
| start_date | DATE | |
| end_date | DATE | |
| gate_review_status | VARCHAR(16) | not_started/in_review/passed/failed/conditional |
| gate_review_date | TIMESTAMP | 评审时间 |
| gate_review_notes | TEXT | 评审决策说明 |

#### tasks (项目任务) — 基本不变

#### project_boms (项目BOM)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | UUID | 主键 |
| project_id | UUID | 关联项目 |
| phase_id | UUID | 关联阶段 |
| bom_type | VARCHAR(16) | EBOM/SBOM/OBOM/FWBOM |
| version | VARCHAR(16) | v1.0, v1.1 |
| name | VARCHAR(128) | 如"微光平台 EVT 电子BOM v1.0" |
| status | VARCHAR(16) | draft/pending_review/published/frozen |
| submitted_by | UUID | 提交人 |
| submitted_at | TIMESTAMP | |
| reviewed_by | UUID | 审批人 |
| reviewed_at | TIMESTAMP | |
| review_comment | TEXT | |
| frozen_at | TIMESTAMP | 冻结时间 |
| parent_bom_id | UUID | 继承自哪个BOM（阶段演进） |
| total_items | INT | 物料行数 |
| estimated_cost | DECIMAL | 预估成本 |

#### bom_items (BOM行项)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | UUID | 主键 |
| bom_id | UUID | 关联BOM |
| material_id | UUID | 关联物料（可选，新物料可先不入库）|
| item_number | INT | 行号 |
| category | VARCHAR(32) | 分类：IC/被动/连接器/结构件/光学/固件... |
| name | VARCHAR(128) | 物料名称 |
| specification | TEXT | 规格描述 |
| quantity | DECIMAL | 数量 |
| unit | VARCHAR(16) | pcs/set/m/kg |
| reference | VARCHAR(256) | 位号 R1,R2,C1,C2... (电子件) |
| manufacturer | VARCHAR(128) | 制造商 |
| manufacturer_pn | VARCHAR(64) | 制造商料号 |
| supplier | VARCHAR(128) | 供应商 |
| unit_price | DECIMAL | 单价(参考) |
| lead_time_days | INT | 交期(天) |
| is_critical | BOOLEAN | 关键物料标记 |
| is_alternative | BOOLEAN | 是否替代料 |
| alternative_for | UUID | 替代哪个BOM Item |
| document_ids | JSONB | 关联图纸ID列表 |
| notes | TEXT | 备注 |

#### documents (研发文档/图纸)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | UUID | 主键 |
| project_id | UUID | 关联项目 |
| phase_id | UUID | 关联阶段 |
| code | VARCHAR(32) | 文档编号 |
| name | VARCHAR(256) | 文档名称 |
| category | VARCHAR(32) | electrical/mechanical/optical/id_design/firmware/test/project |
| current_version | VARCHAR(16) | 当前版本 |
| status | VARCHAR(16) | draft/released/obsolete |
| created_by | UUID | |

#### document_versions (文档版本)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | UUID | 主键 |
| document_id | UUID | |
| version | VARCHAR(16) | v1.0 |
| file_path | VARCHAR(512) | MinIO 存储路径 |
| file_name | VARCHAR(256) | 原始文件名 |
| file_size | BIGINT | 字节 |
| content_type | VARCHAR(64) | MIME类型 |
| change_description | TEXT | 变更说明 |
| ecn_id | UUID | 关联ECN（如有）|
| uploaded_by | UUID | |
| uploaded_at | TIMESTAMP | |

#### phase_deliverables (阶段交付物)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | UUID | 主键 |
| phase_id | UUID | 关联阶段 |
| name | VARCHAR(128) | 交付物名称 |
| type | VARCHAR(16) | document/bom/review |
| responsible_role | VARCHAR(32) | 负责角色 |
| is_required | BOOLEAN | 是否必选 |
| status | VARCHAR(16) | pending/submitted/approved |
| document_id | UUID | 关联文档 |
| bom_id | UUID | 关联BOM |
| submitted_at | TIMESTAMP | |
| submitted_by | UUID | |

#### project_codenames (项目代号库)

| 字段 | 类型 | 说明 |
|------|------|------|
| id | UUID | 主键 |
| codename | VARCHAR(32) | 代号（微光/Nova） |
| codename_type | VARCHAR(16) | platform / product |
| generation | INT | 代次（平台专用，1-20）|
| theme | VARCHAR(64) | 主题说明 |
| is_used | BOOLEAN | 是否已使用 |
| used_by_project_id | UUID | 使用该代号的项目 |

---

## 五、前端UI设计

### 5.1 导航结构（大改）

```
旧导航（CRUD模式）：              新导航（流程驱动）：
┌──────────────┐                ┌──────────────────┐
│ 📊 仪表盘     │                │ 🏠 工作台         │ ← 个人待办/项目概览
│ 📦 产品管理   │ ← 删除         │ 📋 研发项目       │ ← 核心入口
│ 📑 项目模板   │                │    └ 项目详情      │
│ 📂 项目管理   │                │       ├ 甘特图     │
│ 🔩 物料管理   │                │       ├ BOM管理    │ ← 在项目内
│ 📋 BOM管理   │ ← 移入项目内    │       ├ 图纸文档   │ ← 在项目内
│ 🔄 ECN管理   │                │       ├ 交付物     │ ← 新增
│ 📄 文档管理   │                │       └ ECN变更    │ ← 在项目内
│                │                │ 🔧 物料选型库     │ ← 辅助库
│                │                │ 📑 项目模板       │ ← 管理员
│                │                │ ⚙️ 系统设置       │
└──────────────┘                └──────────────────┘
```

**核心变化：BOM、图纸、ECN 不再是独立的顶层菜单，而是项目内部的子页面。**

### 5.2 页面设计

#### 5.2.1 工作台（首页）

```
┌─────────────────────────────────────────────────────────────────┐
│  🏠 工作台                                                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌── 我的待办 ──────────────────────┐  ┌── 项目概览 ──────────┐  │
│  │ 🔴 [微光] EVT BOM待审批          │  │  进行中: 3 个项目     │  │
│  │ 🟡 [Nova] 结构评审DFA 到期明天    │  │  即将评审: 1 个       │  │
│  │ 🔵 [微光] 主板原理图评审 已分配   │  │  已完成: 2 个         │  │
│  │ ⚪ [微光] 器件选型验证 待开始     │  │                      │  │
│  └────────────────────────────────┘  └──────────────────────┘  │
│                                                                  │
│  ┌── 我参与的项目 ────────────────────────────────────────────┐  │
│  │  🔷 微光 (PLT-WG-2026)  │ EVT阶段  │ 进度35% │ ████░░░  │  │
│  │  🔷 Nova (PRD-WG-Nova)  │ Concept  │ 进度10% │ █░░░░░░  │  │
│  │  🔷 晨曦 (PLT-CX-2027)  │ 立项中   │ 进度0%  │ ░░░░░░░  │  │
│  └────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

#### 5.2.2 项目详情页（核心页面）

**采用多Tab布局，所有项目相关内容在一个页面内：**

```
┌─────────────────────────────────────────────────────────────────┐
│  📋 微光 PLT-WG-2026 — nimo 第一代平台                          │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │  Concept ✅ ──▶ EVT 🔵 ──▶ DVT ⬜ ──▶ PVT ⬜ ──▶ MP ⬜  │    │
│  │  (已通过G0)    (进行中)                                   │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌────┬────────┬────────┬────────┬────────┬────────┐            │
│  │概览│ 甘特图  │ BOM    │ 图纸文档│ 交付物  │ ECN    │            │
│  └────┴────────┴────────┴────────┴────────┴────────┘            │
│                                                                  │
│  ╔══ 当前 Tab 内容 ══════════════════════════════════════════╗  │
│  ║                                                            ║  │
│  ║  （根据选中Tab显示不同内容，详见下方各Tab设计）              ║  │
│  ║                                                            ║  │
│  ╚════════════════════════════════════════════════════════════╝  │
└─────────────────────────────────────────────────────────────────┘
```

#### 5.2.3 BOM Tab 设计

```
┌─────────────────────────────────────────────────────────────────┐
│  BOM 管理                                          [+ 提交BOM]  │
│                                                                  │
│  阶段筛选: [全部▾] [EVT]  类型筛选: [全部▾] [EBOM] [SBOM]       │
│                                                                  │
│  ┌── EVT 阶段 BOM ──────────────────────────────────────────┐   │
│  │                                                            │   │
│  │  📗 电子BOM v1.1       │ 已发布 ✅ │ 陈泽斌  │ 2026-03-15 │   │
│  │     156 个物料 │ 预估成本 ¥180.00/台                       │   │
│  │     [查看详情] [导出Excel] [申请变更ECN]                    │   │
│  │                                                            │   │
│  │  📘 结构BOM v1.0       │ 待审批 🟡 │ 王工    │ 2026-03-20 │   │
│  │     42 个物料 │ 预估成本 ¥65.00/台                         │   │
│  │     [查看详情] [审批]                                      │   │
│  │                                                            │   │
│  │  📙 固件BOM v1.0       │ 草稿 ⬜   │ 李工    │ -          │   │
│  │     3 个固件 │                                              │   │
│  │     [编辑] [提交审批]                                      │   │
│  │                                                            │   │
│  └────────────────────────────────────────────────────────────┘   │
│                                                                  │
│  ┌── Concept 阶段 BOM ──────────────────────────────────────┐   │
│  │  📗 概念BOM v1.0       │ 已冻结 🔒 │ 陈泽斌  │ 2026-02-20 │   │
│  └────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
```

#### 5.2.4 BOM 详情/编辑页面

```
┌─────────────────────────────────────────────────────────────────┐
│  📗 EVT 电子BOM v1.1 — 微光平台                    状态: 已发布 │
│                                                                  │
│  提交人: 陈泽斌  │  审批人: 王工  │  共 156 项  │  ¥180.00/台    │
│                                                                  │
│  ┌─────┬──────────────┬──────────┬──────┬───┬────────┬────────┐ │
│  │ # │ 物料名称       │ 规格      │ 数量 │单位│ 供应商  │ 单价    │ │
│  ├─────┼──────────────┼──────────┼──────┼───┼────────┼────────┤ │
│  │ 1  │ 高通QCC5181   │ BGA 5x5mm│  1   │pcs│ 高通    │ ¥45.00 │ │
│  │ 2  │ 电容 100nF    │ 0201     │ 48   │pcs│ 三星    │ ¥0.02  │ │
│  │ 3  │ 电池 120mAh   │ 自定规格  │  2   │pcs│ ATL    │ ¥12.00 │ │
│  │ ...│               │          │      │   │        │        │ │
│  └─────┴──────────────┴──────────┴──────┴───┴────────┴────────┘ │
│                                                                  │
│  📎 关联图纸: Main_PCB_v2.1.SchDoc, Main_PCB_v2.1.PcbDoc        │
└─────────────────────────────────────────────────────────────────┘
```

#### 5.2.5 图纸文档 Tab

```
┌─────────────────────────────────────────────────────────────────┐
│  图纸 & 文档                                     [+ 上传文档]   │
│                                                                  │
│  类别筛选: [全部▾]  阶段筛选: [全部▾]                            │
│                                                                  │
│  ┌── 电子设计 ──────────────────────────────────────────────┐   │
│  │ 📄 Main_PCB_v2.1.SchDoc    │ v2.1 │ 张工  │ 2026-03-12  │   │
│  │ 📄 Main_PCB_v2.1.PcbDoc    │ v2.1 │ 张工  │ 2026-03-12  │   │
│  │ 📄 FPC_Main_v1.0.SchDoc    │ v1.0 │ 李工  │ 2026-03-05  │   │
│  └─────────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌── 结构设计 ──────────────────────────────────────────────┐   │
│  │ 📐 Temple_Right_v3.stp     │ v3.0 │ 王工  │ 2026-03-18  │   │
│  │ 📐 Hinge_Assy_v2.stp       │ v2.0 │ 王工  │ 2026-03-15  │   │
│  └─────────────────────────────────────────────────────────────┘  │
│                                                                  │
│  ┌── ID设计 ────────────────────────────────────────────────┐   │
│  │ 🎨 ID_Concept_v2.psd       │ v2.0 │ 刘工  │ 2026-02-28  │   │
│  │ 🎨 CMF_Spec_v1.pdf         │ v1.0 │ 刘工  │ 2026-02-25  │   │
│  └─────────────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

#### 5.2.6 交付物 Tab

```
┌─────────────────────────────────────────────────────────────────┐
│  交付物清单 — EVT 阶段                                          │
│                                                                  │
│  完成进度: 3/6 (50%)  ████░░░░                                   │
│                                                                  │
│  ┌───┬──────────────────┬────────────┬────────┬────────────────┐ │
│  │ ✅│ 原理图 & PCB文件  │ 硬件工程师  │ 已提交 │ Main_PCB_v2.1 │ │
│  │ ✅│ EVT BOM(eBOM)    │ 硬件工程师  │ 已审批 │ EBOM v1.1     │ │
│  │ ✅│ 光学设计报告      │ 光学工程师  │ 已提交 │ 光学报告v1.pdf │ │
│  │ 🟡│ 结构设计文件      │ 结构工程师  │ 待提交 │ -             │ │
│  │ 🟡│ ID设计定稿        │ 工业设计师  │ 待提交 │ -             │ │
│  │ ⬜│ EVT测试报告       │ 测试工程师  │ 未开始 │ -             │ │
│  └───┴──────────────────┴────────────┴────────┴────────────────┘ │
│                                                                  │
│  ⚠️ 还有 3 项交付物未完成，无法发起 G1 评审                      │
└─────────────────────────────────────────────────────────────────┘
```

---

## 六、ID工业设计 — 任务模板补充

### 6.1 Concept 阶段新增

| 编码 | 任务名 | 父任务 | 角色 | 天数 |
|------|--------|--------|------|------|
| C-50 | ID工业设计 | — | id_lead | 10 |
| C-51 | 产品定位与设计趋势研究 | C-50 | id_designer | 3 |
| C-52 | 概念草图与设计方向 | C-50 | id_designer | 5 |
| C-53 | 概念渲染图输出 | C-50 | id_designer | 3 |
| C-54 | ID概念方案评审 | C-50 | id_lead | 1 |

### 6.2 EVT 阶段补充

原有 E-31 "ID设计(外观造型)" 调整为独立父任务：

| 编码 | 任务名 | 父任务 | 角色 | 天数 |
|------|--------|--------|------|------|
| E-70 | ID工业设计 | — | id_lead | 20 |
| E-71 | 外观方案深化设计 | E-70 | id_designer | 8 |
| E-72 | CMF(色彩/材质/工艺)方案制定 | E-70 | id_designer | 5 |
| E-73 | 外观手板制作与评估 | E-70 | id_designer | 5 |
| E-74 | 佩戴人因工程评估 | E-70 | id_designer | 3 |
| E-75 | ID设计定稿评审 | E-70 | id_lead | 1 |

### 6.3 DVT 阶段

| 编码 | 任务名 | 父任务 | 角色 | 天数 |
|------|--------|--------|------|------|
| D-60 | ID设计验证 | — | id_lead | 8 |
| D-61 | CMF工艺打样验证 | D-60 | id_designer | 5 |
| D-62 | 外观品质标准制定 | D-60 | id_designer | 3 |

---

## 七、技术实现路线

### 7.1 后端改造范围

| 模块 | 改造程度 | 说明 |
|------|----------|------|
| 项目管理 | **中** | 增加代号字段、阶段门控逻辑、交付物管理 |
| 任务管理 | **小** | 基本不变，补充ID设计任务 |
| BOM管理 | **大改** | 从独立模块改为项目子模块，增加提交/审批/冻结流程 |
| 图纸文档 | **大改** | 从简单文档管理改为版本管理+项目关联 |
| ECN管理 | **中** | 增加与BOM的关联，阶段审批链 |
| 物料管理 | **小** | 简化为选型库，去掉库存概念 |
| 产品管理 | **删除** | 整个模块移除，产品概念由项目承载 |

### 7.2 前端改造范围

| 页面 | 改造程度 | 说明 |
|------|----------|------|
| 首页Dashboard | **大改** | 改为工作台（待办+项目概览）|
| 项目列表 | **中** | 增加代号显示、阶段进度条 |
| 项目详情 | **大改** | 多Tab整合（甘特图+BOM+图纸+交付物+ECN）|
| BOM页面 | **大改** | 移入项目内，增加提交审批流程 |
| 图纸页面 | **新建** | 版本管理+分类展示 |
| 交付物页面 | **新建** | checklist + 阶段门控制 |
| 产品管理 | **删除** | 整个页面移除 |

### 7.3 实施阶段建议

**第一期（核心流程打通）：**
1. 后端：项目增加代号 + 阶段门控 + BOM重构（提交/审批/冻结）
2. 前端：项目详情页多Tab + BOM管理UI + 交付物checklist
3. 补充ID设计任务到模板

**第二期（完善体验）：**
1. 图纸文档版本管理
2. ECN与BOM联动
3. 工作台（个人待办）
4. 物料选型库优化

**第三期（集成打通）：**
1. 飞书审批对接（BOM审批/ECN审批/阶段门审批走飞书）
2. 飞书任务同步
3. PLM→ERP接口预留（mBOM推送）

---

## 八、附录：与V1.0流程文档的对应关系

| V1.0流程设计 | V2.0系统落地 |
|-------------|-------------|
| 平台+产品二级体系 | 项目类型字段 + 代号体系 |
| Phase-Gate五阶段 | project_phases表 + 阶段门控逻辑 |
| BOM阶段演进 | project_boms表 + parent_bom_id继承 |
| ECN审批升级 | ECN审批链 + 阶段关联 |
| 140+任务模板 | 已填充到模板系统（+ID设计补充）|
| 角色权限 | 基于角色的审批权限矩阵 |

---

*文档版本: V2.0*
*创建日期: 2026-02-06*
*作者: Claude (BitFantasy AI)*
*审核: 待确认*
